<!DOCTYPE html>
<html lang="en">


<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Authentication middleware for Expressive and PSR-7 applications">  
    <link rel="shortcut icon" href="../../img/favicon.ico">

    <title>Introduction - zend-expressive-authentication</title>

    <link rel="stylesheet" href="../../css/styles-3eb6fab3fb.css">
</head>
<body id="page-top">

    
    <div class="navbar navbar-default" role="navigation">
    <div class="container">
        <div class="navbar-header">

            
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            
            <span class="navbar-brand">
                <a class="logo-link" href="https://framework.zend.com/" data-tooltip data-placement="bottom" title="Go to the ZF homepage">
                    <img src="../../img/zend-framework-logo.svg" height="28" alt="Zend Framework">
                </a>
            </span>
        </div>

        <div class="navbar-collapse collapse">

            
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="https://framework.zend.com/about">About</a>
                </li>
                <li>
                    <a href="https://framework.zend.com/downloads">Install</a>
                </li>
                <li class="active">
                    <a href="https://docs.zendframework.com">Documentation</a>
                </li>
                <li>
                    <a href="https://www.zend.com/en/services/training">Training</a>
                </li>
                <li>
                    <a href="https://framework.zend.com/blog">Blog</a>
                </li>
                <li>
                    <a href="https://framework.zend.com/participate">Participate</a>
                </li>
            </ul>

            
            
                <div class="nav navbar-nav navbar-collapse visible-xs-block ">
                    
    <div class="subnavigation hidden-print">
        <h4 class="subnavigation__title">
            <a href="../..">zend-expressive-authentication</a>
        </h4>

        <h5 class="subnavigation__subtitle">Table of Contents</h5>

        <ul class="subnavigation__list">
            
                
                    <li class="subnavigation__list-item ">
                        <a href="../.." class="subnavigation__link">Expressive Authentication Middleware</a>
                    </li>
                
            
                
                    <li class="subnavigation__list-item subnavigation__list-item--active">
                        <a href="./" class="subnavigation__link">Introduction</a>
                    </li>
                
            
                
                    <li class="subnavigation__list-item">
                        <span class="subnavigation__headline">Reference</span>
                        <ul class="subnavigation__list">
                            
                                
    <li class="subnavigation__list-item ">
        <a href="../auth-adapter/" class="subnavigation__link">Authentication adapter</a>
    </li>

                            
                                
    <li class="subnavigation__list-item ">
        <a href="../user-repository/" class="subnavigation__link">User repository</a>
    </li>

                            
                        </ul>
                    </li>
                
            
        </ul>
    </div>

                </div>
            

            
            <div class="nav navbar-nav navbar-collapse visible-xs-block">
                <div class="component-selector">
    <h4 class="component-selector__title">Components</h4>
    <h5 class="component-selector__subtitle">Find documentation…</h5>
    <select class="form-control component-selector__control">
        <option value="/">Overview</option>
        <optgroup label="Components"></optgroup>
    </select>
</div>
            </div>
        </div>
    </div>
</div>

    
    <header class="header">
    <div class="container">
        <div class="row">

            
            <div class="col-xs-8">
                <h1 class="header__title">
                    Documentation

                    
                        <small class="header__subtitle">zend-expressive-authentication</small>
                    
                </h1>
            </div>

            
            <div class="col-xs-4 text-right">
                
                    <a href="#" class="header__link header__link--search" data-toggle="modal" data-target="#mkdocs_search_modal" title="Open search">
                        <i class="fa fa-search"></i> Search
                    </a>
                    <a href="https://github.com/zendframework/zend-expressive-authentication/" class="header__link header__link--github" title="Go to repository of zend-expressive-authentication">
                        <i class="fa fa-github"></i> GitHub
                    </a>
                
            </div>
        </div>
    </div>
</header>

    
    <div class="container">
        <div class="row">
            <div class="col-md-9 col-xs-12 content" role="main">
            <!-- content:begin -->
                
                    <ol class="breadcrumb" role="navigation" aria-label="breadcrumbs navigation">
  <li><a href="https://framework.zend.com/">Home</a></li>
  <li><a href="https://docs.zendframework.com/">Docs</a></li>
  <li><a href="../..">zend-expressive-authentication</a></li>
  
    
  
  <li class="active">Introduction</li>
</ol>


    
    

    
    
        <div class="toc">
            <h6 class="toc__headline">In This Article</h6>
            <ul class="toc__list">
                
                    <li class="toc__entry">
                        <a href="#default-user-class" class="toc__link">Default User class</a>
                    </li>
                
                    <li class="toc__entry">
                        <a href="#usage-in-the-route" class="toc__link">Usage in the route</a>
                    </li>
                
                    <li class="toc__entry">
                        <a href="#choosing-an-authentication-adapter" class="toc__link">Choosing an authentication adapter</a>
                    </li>
                
            </ul>
        </div>
    


    <h1 id="zend-expressive-authentication">Zend Expressive Authentication</h1>
<p>This component provides authentication abstraction using a middleware approach
for <a href="http://www.php-fig.org/psr/psr-7/">PSR-7</a> and
<a href="https://github.com/php-fig/fig-standards/tree/4b417c91b89fbedaf3283620ce432b6f51c80cc0/proposed/http-handlers">PSR-15</a>
applications.</p>
<p>Authentication is performed using the <a href="https://github.com/zendframework/zend-expressive-authentication/blob/master/src/AuthenticationMiddleware.php">AuthenticationMiddleware</a>
class. This middleware consumes an <a href="https://github.com/zendframework/zend-expressive-authentication/blob/master/src/AuthenticationInterface.php">AuthenticationInterface</a>
adapter to check if a <a href="http://www.php-fig.org/psr/psr-7/">PSR-7</a> request is
authenticated or not. If authenticated, the middleware executes the next
middleware in the application, passing a <a href="https://github.com/zendframework/zend-expressive-authentication/blob/master/src/UserInterface.php">UserInterface</a>
object via a request attribute. If the request is not authenticated, the
middleware returns a <code>401 Unauthorized</code> response based on the authentication
adapter provided.</p>
<p>The <code>Zend\Expressive\Authentication\UserInterface</code> is defined as follows:</p>
<pre class="codehilite"><code class="language-php">namespace Zend\Expressive\Authentication;

interface UserInterface
{
    /**
     * Get the unique user identity (id, username, email address, etc.).
     */
    public function getIdentity() : string;

    /**
     * Get all user roles.
     *
     * @return string[]
     */
    public function getRoles() : array;

    /**
     * Get the detail named $name if present; return $default otherwise.
     */
    public function getDetail(string $name, $default = null);

    /**
     * Get all additional user details, if any.
     */
    public function getDetails() : array;
}</code></pre>

<p>The <code>UserInterface</code> attribute in the PSR-7 request can be used for checking
if a user has been authenticated or not, e.g. it can be used to verify the
authorization level of a user (for this scope, it is consumed by
<a href="https://github.com/zendframework/zend-expressive-authorization">zend-expressive-authorization</a>).</p>
<h2 id="default-user-class">Default User class</h2>
<p>We provide a default implementation of <code>UserInterface</code> via the class
<code>Zend\Expressive\Authentication\DefaultUser</code>. The class is final and immutable,
in order to prevent runtime changes.</p>
<p>Repositories will fetch user information based on the identity, including any
associated roles, and optionally any additional details (full name, email,
profile information, etc.). Often, user data and the objects representing them
are unique to the application. As such, the default repository implementations
we provide allow you to inject a <em>factory</em> for producing the user. This factory
should be a PHP callable with the following signature:</p>
<pre class="codehilite"><code class="language-php">function (string $identity, array $roles = [], array $details = []) : UserInterface</code></pre>

<p>In order to notify the package to use your custom factory, you will need to
create a service factory that returns it, and map it to the
<code>Zend\Expressive\Authentication\UserInterface</code> service.</p>
<p>We provide a service factory named <code>Zend\Expressive\Authentication\DefaultUserFactory</code>
that returns a user factory that produces a <code>DefaultUser</code> instance from the
arguments provided. This is mapped as follows in the service configuration:</p>
<pre class="codehilite"><code class="language-php">use Zend\Expressive\Authentication\DefaultUserFactory;
use Zend\Expressive\Authentication\UserInterface;

return [
    // ...
    'dependencies' =&gt; [
        'factories' =&gt; [
            // ...
            // Change the DefaultUserFactory::class with your custom service
            // factory that produces a user factory:
            UserInterface::class =&gt; DefaultUserFactory::class
        ]
    ]
];</code></pre>

<h2 id="usage-in-the-route">Usage in the route</h2>
<p>The <code>AuthenticationMiddleware</code> can be used to authenticate a route. You just
need to add the class name of the middleware in the pipeline of a route.
As an example:</p>
<pre class="codehilite"><code class="language-php">$app-&gt;get('/admin/dashboard', [
    Zend\Expressive\Authentication\AuthenticationMiddleware::class,
    Admin\Action\Dashboard::class
], 'admin.dashboard');</code></pre>

<p>In this example, the <code>AuthenticationMiddleware</code> is executed as first middleware
of the route <code>admin.dashboard</code>. If the user is authenticated, the application
executes the <code>Dashboard</code> action; otherwise it returns a <code>401 Unauthorized</code>
response.</p>
<h2 id="choosing-an-authentication-adapter">Choosing an authentication adapter</h2>
<p>You can choose an authentication adapter and a user repository through the
service container configuration.</p>
<p>You need to specify the service for authentication using the name
<code>Zend\Expressive\Authentication\AuthenticationInterface</code> and the user registry
using the service name <code>Zend\Expressive\Authentication\UserRepositoryInterface::class</code>.</p>
<p>For instance, using <code>zend-servicemanager</code> you can easily configure these two
services using <code>aliases</code>. Below is an example of configuration using the <em>HTTP
Basic Access Authentication</em> adapter and the <em>htpasswd</em> file as the user
repository.</p>
<pre class="codehilite"><code class="language-php">use Zend\Expressive\Authentication\AuthenticationInterface;
use Zend\Expressive\Authentication\Basic;
use Zend\Expressive\Authentication\UserRepository;
use Zend\Expressive\Authentication\UserRepositoryInterface;

return [
    // ...
    'dependencies' =&gt; [
        // ...
        'aliases' =&gt; [
            // ...
            AuthenticationInterface::class =&gt; Basic\BasicAccess::class,
            UserRepositoryInterface::class =&gt; UserRepository\Htpasswd::class
        ]
    ]
];
</code></pre>



    <nav>
    <ul class="page-nav hidden-print">

        
        <li class="page-nav__item">
            
                <a rel="prev" class="page-nav__link page-nav__link--prev" href="../..">
                    <i class="fa fa-chevron-left"></i> Previous
                </a>
            
        </li>

        
        <li class="page-nav__item">
            
                <a rel="next" class="page-nav__link page-nav__link--next" href="../auth-adapter/">
                    Next <i class="fa fa-chevron-right"></i>
                </a>
            
        </li>
    </ul>
</nav>



    <div class="help-wanted">
        <p>
            Found a mistake or want to contribute to the documentation?
            <a href="https://github.com/zendframework/zend-expressive-authentication/edit/master/docs/book/v1/intro.md" target="_blank" class="help-wanted__link">
                Edit this page on GitHub!
            </a>
        </p>
    </div>

                
            <!-- content:end -->
            </div>
            <div class="col-md-3 col-xs-12 sidebar">
                
                    <div class="component-selector">
    <h4 class="component-selector__title">Components</h4>
    <h5 class="component-selector__subtitle">Find documentation…</h5>
    <select class="form-control component-selector__control">
        <option value="/">Overview</option>
        <optgroup label="Components"></optgroup>
    </select>
</div>
                    
    <div class="subnavigation hidden-print">
        <h4 class="subnavigation__title">
            <a href="../..">zend-expressive-authentication</a>
        </h4>

        <h5 class="subnavigation__subtitle">Table of Contents</h5>

        <ul class="subnavigation__list">
            
                
                    <li class="subnavigation__list-item ">
                        <a href="../.." class="subnavigation__link">Expressive Authentication Middleware</a>
                    </li>
                
            
                
                    <li class="subnavigation__list-item subnavigation__list-item--active">
                        <a href="./" class="subnavigation__link">Introduction</a>
                    </li>
                
            
                
                    <li class="subnavigation__list-item">
                        <span class="subnavigation__headline">Reference</span>
                        <ul class="subnavigation__list">
                            
                                
    <li class="subnavigation__list-item ">
        <a href="../auth-adapter/" class="subnavigation__link">Authentication adapter</a>
    </li>

                            
                                
    <li class="subnavigation__list-item ">
        <a href="../user-repository/" class="subnavigation__link">User repository</a>
    </li>

                            
                        </ul>
                    </li>
                
            
        </ul>
    </div>

                
            </div>
        </div>
    </div>

    
    <footer class="footer">
    <div class="container">
        <div class="row">
            <div class="col-md-9">
                <h5>Zend Framework</h5>
                <ul>
                    <li><a href="https://framework.zend.com/">framework.zend.com</a></li>
                    <li><a href="https://docs.zendframework.com">docs.zendframework.com</a></li>
                    <li><a href="https://packages.zendframework.com">packages.zendframework.com</a></li>
                    <li><a href="https://apigility.org">apigility.org</a></li>
                    <li><a href="https://getexpressive.org/">getexpressive.org</a></li>
                </ul>
            </div>
        </div>

        
        <div class="row">
            <div class="col-md-12 text-center">
                <a class="footer__button" href="#page-top"><i class="fa fa-chevron-up" aria-hidden="true"></i></a>
            </div>
        </div>

        <div class="row">

            
            <div class="col-md-9">
                <h4 class="footer__headline">Copyright</h4>
                <p>&copy; 2006-2018 by <a href="https://www.zend.com/">Zend</a>, a <a href="https://www.roguewave.com/">Rogue Wave Company</a>.</p>
            </div>

            
            <div class="col-md-3">
                <h4 class="footer__headline">Support</h4>
                <ul class="support__list">
                    <li class="support__list-item">
                        <a href="https://discourse.zendframework.com" class="support__link" title="Forum"><i class="fa fa-comments"></i></a>
                    </li>
                    <li class="support__list-item">
                        <a href="https://zendframework-slack.herokuapp.com" class="support__link" title="Chat"><i class="fa fa-slack"></i></a>
                    </li>
                    <li class="support__list-item">
                        <a href="https://github.com/zendframework" class="support__link" title="Github"><i class="fa fa-github"></i></a>
                    </li>
                    <li class="support__list-item">
                        <a href="https://twitter.com/zfdevteam" class="support__link" title="Twitter"><i class="fa fa-twitter"></i></a>
                    </li>
                    <li class="support__list-item">
                        <a href="https://tinyletter.com/mwopzend" class="support__link" title="Newsletter"><i class="fa fa-envelope"></i></a>
                    </li>
                    <li class="support__list-item">
                        <a href="https://framework.zend.com/blog/feed-rss.xml" class="support__link" title="Blog feed"><i class="fa fa-rss"></i></a>
                    </li>
                    <li class="support__list-item">
                        <a href="https://framework.zend.com/security/feed" class="support__link" title="Security feed"><i class="fa fa-rss-square"></i></a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</footer>

    <script>
        var base_url = '../..',
            siteName = 'zend-expressive-authentication';
    </script>
    <script src="../../js/scripts-a978f1ec1a.js"></script>
        <script src="../../search/require.js"></script>
        <script src="../../search/search.js"></script>

    
    <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">
                        <span aria-hidden="true">&times;</span>
                        <span class="sr-only">Close</span>
                    </button>
                    <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                </div>
                <div class="modal-body">
                    <p>
                        From here you can search these documents. Enter your search terms below.
                    </p>
                    <form role="form">
                        <div class="form-group">
                            <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                        </div>
                    </form>
                    <div id="mkdocs-search-results"></div>
                </div>
                <div class="modal-footer">
                </div>
            </div>
        </div>
    </div>



</body>


</html>
